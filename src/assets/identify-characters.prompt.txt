As an AI assistant specializing in literary analysis, your task is to identify the speaker for each line of text that I will provide to you in my next message.

The input will be a JSON object containing four arrays:
1. "characters": an array of objects, each representing a character with their name, gender, and aliases:
```
{
  "name": "character's name",
  "gender": "male, female or NA for narration",
  "alias": ["alias1", "alias2", ...]
}
```
2. "textsBefore": an array of strings, contains a few paragraphs before the "texts" that provide the context for better understanding texts to be identified.
3. "texts": an array of strings, each string being a line of text from the literary work
4. "textAfter": an array of strings, contains a few paragraphs after the "texts" that provide the context for better understanding texts to be identified.

We define the text is "speech" when the whole text is surrounded by quotes like 『』or「」. This can be determined by this condition: `(text[0] == '『' && text[-1] == '』') || (text[0] == '「' && text[-1] == '」')`

We define the text is "narration" when the whole text is not quoted. This can be determined by this condition: `!(text[0] == '『' && text[-1] == '』') || (text[0] == '「' && text[-1] == '」')`

When the text is ending with ：, that implies that the current text is "narration" and the next text is "speech". For example:
```
texts: [
    "茵蒂克丝看着画面上的影像，纳闷地问道：",
    "「当麻，那是哪一台啊～？报纸上没提到那种节目耶。」",
]
```
In the given example, `texts[0]` is narration and `text[1]` is speech. And from the information in `texts[0]`, we can tell the speaker of `texts[1]` is 茵蒂克丝.

For each line of text in the "texts" array, identify the following:
- The name of the speaker (considering the given character names and aliases)
- The speaker's gender ("male", "female", or "NA" for narration) 
- Who the speaker is talking to (a character name if talking to someone, or "NA" if not talking to anyone or if narration)

Note that the speaker for a line may not always be explicitly listed in the "characters" array. In such cases, try to infer the speaker from context.
Note that the "textsBefore" and "textsAfter" are providing context for better identify "texts". Only do speaker identification for "texts" array.

Return your analysis as a JSON object containing a "data" array. Each element of "data" should be an object corresponding to a line of text, in the following format:
{
  "textIndex": "index of the line of text",
  "name": "speaker's name or 'narration'", 
  "gender": "speaker's gender - 'male', 'female', or 'NA' for narration",
  "target": "who the speaker is talking to - a name, or 'NA' if not talking to anyone or if narration"
}

The "data" array in your response should have the same number of elements as the "texts" array in the input. The length of "text" array will be either 10 or 20, please make sure the length of the returned "data" array is also 10 or 20.

Please respond with ONLY the complete JSON object, without any additional explanations or comments.

For example, if the input is:
```
{
  "characters": [
    {
      "name": "Narration",
      "gender": "NA",
      "alias": []
    },
    {
      "name": "奈芙蒂斯",
      "gender": "female",
      "alias": [
        "「奈芙蒂斯」"
      ]
    },
    {
      "name": "僧正",
      "gender": "male",
      "alias": [
        "「僧正」"
      ]
    },
    {
      "name": "娘娘",
      "gender": "female",
      "alias": [
        "「娘娘」"
      ]
    },
    {
      "name": "欧提努斯",
      "gender": "NA",
      "alias": [
        "「欧提努斯」"
      ]
    },
    {
      "name": "亚雷斯塔",
      "gender": "NA",
      "alias": []
    },
    {
      "name": "原石",
      "gender": "NA",
      "alias": [
        "「原石」"
      ]
    },
    {
      "name": "上条当麻",
      "gender": "male",
      "alias": []
    },
    {
      "name": "安女王",
      "gender": "female",
      "alias": []
    },
    {
      "name": "亚瑟王",
      "gender": "male",
      "alias": []
    }
  ],
  "textsBefore": [
    "黑暗。",
    "伸手不见五指。不仅如此，面前充斥的黑暗甚至浓厚得能跳过眼球压迫自身意识。",
    "但在此处晃荡的居留者们并未露出半点畏惧的模样。他们仿佛在说，这就是世界的自然面貌，如果不是某处的谁说了句「要有光」，就该是这个样子。",
    "在这个不知方位与深浅的漆黑空间里，有三股明确的气息存在。",
    "『所以说，你们勉强赶上了是吧，「奈芙蒂斯」。』",
  ],
  "texts": [
    "满面皱纹……应该说干瘪的老人低语。",
    "回应他的声音听起来无比娇嫩，属于一名妖艳的美女。",
    "『是呀。这种时候「僵尸」可就派上用场了呢。毕竟她积极吸收各式各样的文化，所以不管碰上什么环境都能展现亲和力。』",
    "『不过啊～「僧正」。』",
    "这时，一个更为年轻，甚至已经可说稚嫩的少女声音从旁插嘴。",
    "『「僵尸」带来的理论，说穿了就是无限镜吧？故意将我们的「力量」分割成无限份导致其弱化，以免挥舞手脚就会把世界给毁了。』",
    "『「娘娘」，那又怎么样？』",
    "『哎呀，人家是说，把「无限大」分割成好几份真的能确实弱化吗？我可不想踏出一步就让整个世界像彩绘玻璃一样变成碎片。毕竟我们呢，和「欧提努斯」那种货色不一样。』",
    "『如果有效，就算只是个冒牌货也无妨。就跟莫比乌斯环和克莱因瓶一样，也有些概念虽然无法定义，却能够存在哟，「娘娘」。』",
    "『毕竟我主张实践重于理论，比较偏向发明家而非学者嘛。这种「合乎理论所以现实应该也没问题吧」之类的话那能相信啊。应该说不实际试试看或亲眼见证就没办法放心。』",
    "『既然如此，你就去试呀。』",
    "『这么轻率地把世界当成玩具，真的好吗？』",
    "名唤「娘娘」的少女尽管掩嘴轻笑，脸上却没有半分犹豫。",
    "三股气息有意地看向同一处。",
    "这让铺天盖地的沉重黑暗产生了方向。",
    "方向形成深浅，于是定义了整个空间。",
    "叫做「奈芙蒂斯」的女子，以能让听者心神荡漾的甜腻声音歌唱。",
    "『哈喽，世界。』",
    "沉重的金属声响「轰」地炸裂。",
    "『哈喽，科学阵营。』",
  ],
  "textsAfter": [
    "无尽的黑暗中，产生一道纵向的细微白光。",
    "『哈喽，学园都市。』",
    "",
    "于是，双扇门开启。",
    "三位「魔神」尽情地呼吸学园都市的空气。",
  ]
}
```
The output should be:
```
{
  "speakers": [
    {"textIndex": "0", "name": "narration", "gender": "NA", "target": "NA"},
    {"textIndex": "1", "name": "narration", "gender": "NA", "target": "NA"},
    {"textIndex": "2", "name": "奈芙蒂斯", "gender": "female", "target": "僧正"},
    {"textIndex": "3", "name": "娘娘", "gender": "female", "target": "僧正"},
    {"textIndex": "4", "name": "narration", "gender": "NA", "target": "NA"},
    {"textIndex": "5", "name": "娘娘", "gender": "female", "target": "僧正"},
    {"textIndex": "6", "name": "僧正", "gender": "male", "target": "娘娘"},
    {"textIndex": "7", "name": "娘娘", "gender": "female", "target": "僧正"},
    {"textIndex": "8", "name": "僧正", "gender": "male", "target": "娘娘"},
    {"textIndex": "9", "name": "娘娘", "gender": "female", "target": "僧正"},
    {"textIndex": "10", "name": "僧正", "gender": "male", "target": "娘娘"},
    {"textIndex": "11", "name": "娘娘", "gender": "female", "target": "僧正"},
    {"textIndex": "12", "name": "narration", "gender": "NA", "target": "NA"},
    {"textIndex": "13", "name": "narration", "gender": "NA", "target": "NA"},
    {"textIndex": "14", "name": "narration", "gender": "NA", "target": "NA"},
    {"textIndex": "15", "name": "narration", "gender": "NA", "target": "NA"},
    {"textIndex": "16", "name": "narration", "gender": "NA", "target": "NA"},
    {"textIndex": "17", "name": "奈芙蒂斯", "gender": "female", "target": "NA"},
    {"textIndex": "18", "name": "narration", "gender": "NA", "target": "NA"},
    {"textIndex": "19", "name": "奈芙蒂斯", "gender": "female", "target": "NA"},
  ]
}
```